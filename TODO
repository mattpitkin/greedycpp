Some items to do

1) computing waveforms on the fly instead upfront 

2) code should be checkpointable

3) binary or hdf5 output? ignore basis.txt output?

4) role weights into ts components and use Euclidean inner product. Will be faster

5) finish checking ND TS from file routine
